<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets">
<ui:composition template="/jsp/include/template.xhtml">
	<ui:define name="breadcrumb">
		<h:panelGroup id="pnlBread">
			<h:outputLabel value="RelatÃ³rio de #{msgsChecklist['BREAD']}" />
		</h:panelGroup>
	</ui:define>
	<ui:define name="conteudo">
		<script type="text/javascript">
			jQuery.fn.enterSubmit = function(){
				jQuery(this).live("keypress", function(e) {
			        /* ENTER PRESSED*/
			        if (e.keyCode == 13) {
				        this.value = this.value.replace(/_/g, "");
			        	jQuery(".btn-consultar").click();
			        	return false;
			        }
			        return true;
			    });
			};

			function checkForConfirmation(existe) {
				if(existe)
				{
					if(confirm('#{msgsCef['MA010']}'))
					{
						jsReplaceChecklist();
					} else {
						return false;
					}
				}
				else 
				{
					jsSaveChecklist();
				}
			}
		</script>
		<a4j:form id="formChecklist">
			<a4j:keepAlive beanName="checklistMB" />		

			<rich:panel id="pnlConteudo">
				<rich:spacer
					height="10px"
					width="1px" />
				<rich:panel
					id="pnlConsultarAvancado"
					styleClass="panel-externo">
					<rich:jQuery id="mskDateRel" selector=".maskDate" timing="onload" query="mask('99/99/9999')" />
					<table
						cellpadding="0"
						cellspacing="0"
						id="tabelaConsulta"
						class="estiloTabelaPadrao">
						<tr>
							<td width="50px"><h:outputLabel
									id="lblPesqOperacao"
									styleClass="rotulosPro"
									value="#{msgsChecklist['LABEL.operacao']} " />
							</td>
							<td width="60px">
								<h:inputText
									value="#{checklistMB.checklistVO.operacao}"
									styleClass="forms_input pressEnter"
									style="width: 100px;"
									tabindex="1"
									id="edtCampoOperacao"
									maxlength="4"
									size="4"
									onfocus="type_masktype(false)">
									<rich:jQuery
										id="mascaraOperacao"
										selector="#edtCampoOperacao"
										query="mask('9999')"
										timing="onload" />
									<rich:jQuery
										selector="#edtCampoOperacao"
										query="enterSubmit()"
										timing="onload" />
									<a4j:support
										event="onblur"
										oncomplete="jsAtualizaComboProduto();"
										
										reRender="selectProduto"/>
								</h:inputText>
								<a4j:jsFunction id="jsAtualizaComboProduto" name="jsAtualizaComboProduto" reRender="selectProduto"></a4j:jsFunction>
							</td>
							<td
								colspan="3"
								width="50px"><h:outputLabel
									id="lblPesqSituacao"
									styleClass="rotulosPro"
									value="#{msgsChecklist['LABEL.situacao']} " />
							</td>
							<td style="width: 170px; *width: 163px"><h:selectOneMenu
									value="#{checklistMB.checklistVO.situacao}"
									id="selectSituacao"
									tabindex="2"
									styleClass="forms_input"
									style="width: 290px;">
									<f:selectItem
										itemLabel="Selecione..."
										itemValue="" />
									<f:selectItems
										id="selectItems_Situacao"
										value="#{checklistMB.listSituacoes}" />
								</h:selectOneMenu>
							</td>
							<td style="width: 60px;">
								<div style="width: 90px;">
									<h:outputLabel
										id="lblPesqDataInicio"
										styleClass="rotulosPro"
										value="#{msgsChecklist['LABEL.datainicio']} " />
								</div>
							</td>
							<td style="width: 120px;">
								<div style="*width: 110px;">
									<rich:calendar
										id="calendDataIni"
										tabindex="3"
										enableManualInput="true"
										oninputblur="validaData(this)"										
										inputClass="forms_input maskDate"
										datePattern="dd/MM/yyyy"
										inputSize="10"
										firstWeekDay="0"
										value="#{checklistMB.checklistVO.dataInicio}">
									</rich:calendar>
								</div>
							</td>
						</tr>
						<tr>
							<td><h:outputLabel
									id="lblPesqProduto"
									styleClass="rotulosPro"
									value="#{msgsChecklist['LABEL.produto']} " />
							</td>
							<td><h:inputText
									value="#{checklistMB.checklistVO.filtroProduto}"
									styleClass="forms_input pressEnter"
									style="width: 100px;"
									id="lblPesqCampoNome"
									maxlength="30"
									tabindex="1"
									size="8">
									<rich:jQuery
										selector="#lblPesqCampoNome"
										query="enterSubmit()"
										timing="onload" />
									<a4j:support
										event="onblur"
										reRender="selectProduto" />
								</h:inputText>
							</td>
							<td
								colspan="4"
								style="width: 467px;">
								<h:selectOneMenu
									value="#{checklistMB.checklistVO.codProduto}"
									id="selectProduto"
									tabindex="4"
									styleClass="forms_input pressEnter"
									style=" width : 385px;">
									<f:selectItem
										itemLabel="Selecione..."
										itemValue="" />
									<f:selectItems
										id="selectItemsProduto"
										value="#{checklistMB.listProdutos}" />
									<rich:jQuery
										selector="#selectProduto"
										query="enterSubmit()"
										timing="onload" />
									<a4j:support
										event="onchange"
										reRender="selectServico"
										ajaxSingle="true" />
								</h:selectOneMenu>
							</td>
							<td><h:outputLabel
									id="lblPesqDataFim"
									styleClass="rotulosPro"
									value="#{msgsChecklist['LABEL.datafim']} " />
							</td>
							<td><rich:calendar
									id="calendDataFim"
									inputClass="forms_input maskDate"
									enableManualInput="true"
									oninputblur="validaData(this)"									
									tabindex="5"
									inputSize="10"
									firstWeekDay="0"
									datePattern="dd/MM/yyyy"
									value="#{checklistMB.checklistVO.dataFim}">
								</rich:calendar>
							</td>
						</tr>
						<tr>
							<td colspan="2"><h:outputLabel
									id="lblPesqServicoVerif"
									styleClass="rotulosPro"
									value="#{msgsChecklist['LABEL.servicoverificacao']} " />
							</td>
							<td colspan="4"><h:selectOneMenu
									value="#{checklistMB.checklistVO.codServicoVerificacao}"
									id="selectServico"
									tabindex="6"
									styleClass="forms_input"
									readonly="false"
									style="width: 385px; ">
									<f:selectItem
										itemLabel="Selecione..."
										itemValue="" />
									<f:selectItems
										id="selectItems_ServicoVerif"
										value="#{checklistMB.listServicoVerificacao}" />
								</h:selectOneMenu>
							</td>
							<td colspan="2"><h:selectBooleanCheckbox value="#{checklistMB.checklistVO.revogado}" /> <h:outputText
									value="#{msgsChecklist['LABEL.inclusiveRevogados']}"
									styleClass="rotulos" />
							</td>
						</tr>
						<tr>
							<td colspan="2"><h:outputLabel
									value="#{msgsChecklist['LABEL.tipoCanalComercializacao']}:"
									styleClass="rotulosPro" />
							</td>
							<td colspan="4"><h:selectOneMenu
									value="#{checklistMB.checklistVO.nuCanal}"
									styleClass="forms_input"
									style="width: 385px">
									<f:selectItem
										itemLabel="Selecione..."
										itemValue="" />
									<f:selectItems value="#{checklistMB.listTipoCanalComercializacao}" />
								</h:selectOneMenu>
							</td>
							<td colspan="2"><a4j:commandButton
									id="btnfiltrarChecklistFiltroAvancado"
									styleClass="rich-button btn-consultar"
									value="#{msgsChecklist['ACTION.filtrar']}"
									actionListener="#{checklistMB.doConsultarRelatorioClick}"
									reRender="conteudo, CEFMessagePanel, tableChecklist, pnlBread"
									status="sts" /> <rich:spacer width="5" /></td>
						</tr>
					</table>
				</rich:panel>
				<!-- do pnlConsulta -->
				<rich:panel
					id="pnlTituloGrid"
					style="vertical-align: bottom; padding:6px 0px; text-align:left;"
					rendered="#{checklistMB.showDataTable}">
					<h:graphicImage
						value="/images/icon_estagiarios_.gif"
						style="vertical-align: bottom;" />
					<h:outputText
						value="#{msgsChecklist['TITLE.listachecklist']}"
						styleClass="tituloPagina" />
				</rich:panel>
				<!-- do pnlTituloGrid -->
				<rich:dataTable
					id="tableChecklist"
					value="#{checklistMB.listChecklists}"
					var="checklist"
					rows="10"
					width="100%"
					cellspacing="0"
					cellpadding="0"
					border="1"
					rowClasses="tabela-row-1, tabela-row-2"
					onRowMouseOver="this.style.backgroundColor = '#A2B6E5'"
					onRowMouseOut="this.style.backgroundColor = ''"
					rendered="#{checklistMB.showDataTable}">
					<rich:column
						id="colCodigoProduto"
						style="text-align:center;"
						width="10%"
						sortBy="#{checklist.servicoVerificacaoProduto.produto.coProduto}">
						<f:facet name="header">
							<h:outputText
								id="lblCodigoProduto"
								styleClass="rotulosPro"
								value="#{msgsChecklist['COLUMN.codigo']}" />
						</f:facet>
						<h:outputText
							style="color:#38599C"
							id="lblNuProduto"
							value="#{checklist.servicoVerificacaoProduto.produto.codigoFormatado}" />
					</rich:column>
					<rich:column
						id="colNomeProduto"
						style="text-align:left;"
						sortBy="#{checklist.servicoVerificacaoProduto.produto.noProduto}">
						<f:facet name="header">
							<h:outputText
								id="lblNomeProduto"
								styleClass="rotulosPro"
								value="#{msgsChecklist['COLUMN.nomeproduto']}" />
						</f:facet>
						<h:outputText
							style="color:#38599C"
							id="lblNoProduto"
							value="#{checklist.servicoVerificacaoProduto.produto.noProduto}" />
					</rich:column>
					<rich:column
						id="colServicoVerificacao"
						style="text-align:left;"
						sortBy="#{checklist.servicoVerificacaoProduto.servicoVerificacao.noServicoVerificacao}">
						<f:facet name="header">
							<h:outputText
								id="lblServicoVerif"
								styleClass="rotulosPro"
								value="#{msgsChecklist['COLUMN.servicoverificacao']}" />
						</f:facet>
						<h:outputText
							style="color:#38599C"
							id="txtServicoVerif"
							value="#{checklist.servicoVerificacaoProduto.servicoVerificacao.noServicoVerificacao}" />
					</rich:column>
					<rich:column
						id="colSituacao"
						style="text-align:left;"
						sortBy="#{checklist.icSituacao}">
						<f:facet name="header">
							<h:outputText
								id="lblSituacao"
								styleClass="rotulosPro"
								value="#{msgsChecklist['COLUMN.situacao']}" />
						</f:facet>
						<h:outputText
							style="color:#38599C"
							id="txtSituacao"
							value="#{checklist.icSituacao}" />
					</rich:column>
					<rich:column
						id="colRevogado"
						style="text-align:left;"
						sortBy="#{checklist.icRevogado}">
						<f:facet name="header">
							<h:outputText
								id="lblRevogado"
								styleClass="rotulosPro"
								value="#{msgsChecklist['COLUMN.revogado']}" />
						</f:facet>
						<h:outputText
							style="color:#38599C"
							value="#{checklistMB.revogadoFormatado}" />
					</rich:column>
					<rich:column
						id="colAcaoChecklist"
						headerClass="th-text-center"
						width="50px"
						styleClass="iconesCentro">
						<f:facet name="header">
							<h:outputText
								id="lblAcaoChecklist"
								styleClass="rotulosTabela"
								value="#{msgsChecklist['ACTION.acao']}" />
						</f:facet>
						<a4j:commandLink
							id="lnkRelatorioChecklist"
							actionListener="#{checklistMB.doGerarRelatorio}"
							style="border-style:none;border-width:0;"
							reRender="messages_CEFMessagePanel_download, download"
							oncomplete="#{rich:component('download')}.show()"
							status="sts">
							<h:graphicImage
								id="imgExcluirChecklist"
								styleClass="action-icon"
								alt="Gerar RelatÃ³rio"
								title="Gerar RelatÃ³rio"
								value="/images/file-pdf.png" />
						</a4j:commandLink>
					</rich:column>
					<f:facet name="footer">
						<rich:datascroller
							fastControls="false"
							inactiveStyleClass="classe-datascroller classe-datascroller-unselected"
							selectedStyleClass="classe-datascroller classe-datascroller-selected"
							id="dataFooterChecklist"
							renderIfSinglePage="false">
							<f:facet name="first">
								<h:graphicImage value="/images/tabela/seta_primeiro.gif" />
							</f:facet>
							<f:facet name="first_disabled">
								<h:graphicImage value="/images/tabela/seta_primeiro.gif" />
							</f:facet>
							<f:facet name="last">
								<h:graphicImage value="/images/tabela/seta_ultimo.gif" />
							</f:facet>
							<f:facet name="last_disabled">
								<h:graphicImage value="/images/tabela/seta_ultimo.gif" />
							</f:facet>
							<f:facet name="previous">
								<h:graphicImage value="/images/tabela/seta_anterior.gif" />
							</f:facet>
							<f:facet name="previous_disabled">
								<h:graphicImage value="/images/tabela/seta_anterior.gif" />
							</f:facet>
							<f:facet name="next">
								<h:graphicImage value="/images/tabela/seta_proximo.gif" />
							</f:facet>
							<f:facet name="next_disabled">
								<h:graphicImage value="/images/tabela/seta_proximo.gif" />
							</f:facet>
						</rich:datascroller>
					</f:facet>
				</rich:dataTable>
				<br />
				<rich:modalPanel
					id="download"
					width="300"
					height="100">
					<f:facet name="header">
						<h:outputText value="EmissÃ£o de RelatÃ³rio" />
					</f:facet>
					<f:facet name="controls">
						<h:panelGroup>
							<a4j:commandLink
								id="modalSair"
								onclick="#{rich:component('download')}.hide()">
								<h:graphicImage value="/images/close.png" />
							</a4j:commandLink>
							<rich:componentControl
								for="download"
								attachTo="modalSair"
								operation="hide"
								event="oncomplete" />
						</h:panelGroup>
					</f:facet>
					<h:panelGroup
						layout="block"
						style="text-align: center;">
						<rich:messages
							id="messages_CEFMessagePanel_download"
							showDetail="false"
							showSummary="true"
							errorClass="rotulo"
							warnClass="rotulo"
							infoClass="rotulo"
							fatalClass="rotulo"
							rendered="#{checklistMB.errorDownload}">
							<f:facet name="infoMarker">
								<h:graphicImage
									value="/images/infoicon.gif"
									style="margin-right:10px" />
							</f:facet>
							<f:facet name="errorMarker">
								<h:graphicImage
									value="/images/falta.gif"
									style="margin-right:10px" />
							</f:facet>
							<f:facet name="warnMarker">
								<h:graphicImage
									value="/images/warnIcon2.gif"
									style="margin-right:10px" />
							</f:facet>
						</rich:messages>
						<h:outputText
							rendered="#{!checklistMB.errorDownload}"
							style="font-size: 15px;"
							value="RelatÃ³rio disponÃ­vel" />
						<br />
						<rich:spacer height="30" />
						<h:commandButton
							value="Visualizar"
							styleClass="rich-button"
							id="fecharModalDownload"
							rendered="#{!checklistMB.errorDownload}"
							action="#{checklistMB.downloadRel}">
							<rich:componentControl
								for="download"
								attachTo="fecharModalDownload"
								operation="hide"
								event="onclick" />
						</h:commandButton>
					</h:panelGroup>
				</rich:modalPanel>
				<rich:spacer
					height="0"
					width="175" />
			</rich:panel>
			<!-- do pnlConteudo -->
		</a4j:form>
	</ui:define>
</ui:composition>
</html>